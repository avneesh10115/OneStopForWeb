<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Timetable - OneStop for Web</title>
    <!-- Including Font Awesome CDN for location icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KY4mI2fV2R+1lIhVBdGZVtN/0cZbHBHgiD9lAUNXS8rCfDq3Kr+1r0p0MVLw/BxGc5BeIrsF+MG1q1shFp74xw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/styles.css">
  </head>
  <style>
  .divider {
    border: 0;
    height: 2px;
    margin: 20px 0;
    background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,0.75), rgba(0,0,0,0));
  }
</style>
  <body>
    <%- include('inc/header', { page: 'timetable' }) %>
    
    <div class="timetable-page container">
      <!-- Display user's department and semester (from session) -->
      <div class="user-info">
        <p>Department: <strong><%= department %></strong></p>
        <p>Semester: <strong><%= semester %></strong></p>
      </div>

      <!-- Day selection drop-down -->
      <div class="day-selection">
        <form method="GET" action="/timetable">
          <label for="day-select">Select Day: </label>
          <select id="day-select" name="day" onchange="this.form.submit()">
            <% days.forEach(function(day) { %>
              <option value="<%= day %>" <%= day === selectedDay ? "selected" : "" %>><%= day %></option>
            <% }); %>
          </select>
        </form>
      </div>

      <h2><%= selectedDay %> Timetable</h2>

      <!-- Courses container: sorted by class timing -->
      <div class="courses-container">
        <% if (courses && courses.length) { %>
          <% courses.forEach(function(course) { %>
            <div class="course-card">
              <h3 class="course-title"><%= course.course_name %> (<%= course.course_code %>)</h3>
              <p class="class-timing">
                <span class="label">Class Timing:</span>
                <%= course.lab_slot ? course.lab_slot : course.class_timing %>
              </p>
              
              <% if (course.instructor) { %>
              <p class="instructor">
                <span class="label">Instructor:</span> <%= course.instructor || "TBA" %>
              </p>
              <% } %>
              <% if (course.venue) { %>
              <p class="venue">
                <span class="label">Venue:</span>
                <i class="fas fa-map-marker-alt"></i> <%= course.venue %>
              </p>
              <% } %>
              
            </div>
            <% if (course.lab_slot) { %>
              <hr class="divider">
              <h3 class="course-title"> Theory Courses</h3>
            <% } %>
          <% }); %>
        <% } else { %>
          <p>No courses available for this day.</p>
        <% } %>
      </div>
    </div>

    <footer>
      <p>&copy; <%= new Date().getFullYear() %> OneStop for Web</p>
    </footer>
  </body>
</html>
